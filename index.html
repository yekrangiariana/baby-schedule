<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover"
    />
    <title>Baby Tracker</title>
    <link rel="stylesheet" href="styles.css" />
    <meta name="theme-color" content="#FFF5F7" />
  </head>
  <body>
    <!-- Main Screen -->
    <div class="screen" id="homeScreen">
      <header class="screen-header">
        <h1>ğŸ‘¶ Baby Tracker</h1>
      </header>

      <main class="screen-content">
        <!-- Today's Summary -->
        <section class="today-summary">
          <h2>ğŸ“Š Today's Summary</h2>
          <div class="now" id="nowText"></div>
          <div class="today-stats" id="todayTotals">Loading...</div>
          <div
            class="sync-notice sync-notice-warning"
            id="syncNoticeWarning"
            hidden
          >
            <span>ğŸ’¡ Data stored locally only.</span>
            <button class="sync-notice-link" id="syncNoticeLink">
              Connect Google Sheets
            </button>
          </div>
        </section>

        <!-- Recent Activity -->
        <section class="recent-activity">
          <h3>Recent Activity</h3>
          <div class="recent-list" id="recentList"></div>
        </section>

        <!-- Quick Actions -->
        <section class="quick-actions">
          <h3>Log Activity</h3>
          <div class="action-buttons" id="actionButtons">
            <!-- Action buttons will be rendered dynamically -->
          </div>
        </section>
      </main>
    </div>

    <!-- Activity Log Screen (Full Page) -->
    <div class="screen screen-modal" id="logScreen" hidden>
      <header class="screen-header">
        <h1>ğŸ“‹ Activity Log</h1>
      </header>

      <main class="screen-content">
        <!-- Combined Summary Overview -->
        <div class="log-summary-card" id="logSummaryCard">
          <!-- Dynamic summary will be rendered here -->
        </div>

        <div class="summary" id="summary"></div>

        <div class="screen-toolbar">
          <input type="date" id="dateFilter" class="date-input" />
          <button id="clearFilterBtn" class="btn-small">Clear</button>
        </div>

        <div class="log-entries" id="logEntries"></div>
      </main>
    </div>

    <!-- Insights Screen (Full Page) -->
    <div class="screen screen-modal" id="insightsScreen" hidden>
      <header class="screen-header">
        <h1>ğŸ“ˆ Insights</h1>
        <div></div>
      </header>

      <main class="screen-content">
        <div class="graphs-container">
          <div class="graph-card">
            <h3>Today's Activity</h3>
            <canvas id="todayChart" width="300" height="200"></canvas>
            <div class="graph-legend" id="todayLegend">
              <!-- Legend will be rendered dynamically -->
            </div>
          </div>
          <div class="graph-card">
            <h3>7-Day Trend</h3>
            <canvas id="weekChart" width="300" height="200"></canvas>
            <div class="graph-legend" id="weekLegend">
              <!-- Legend will be rendered dynamically -->
            </div>
          </div>
          <div class="graph-card">
            <h3>Last 24 Hours</h3>
            <div class="graph-legend" id="hourlyLegend">
              <!-- Legend will be rendered dynamically -->
            </div>
            <canvas id="hourlyChart" width="300" height="200"></canvas>
          </div>
          <div class="graph-card">
            <h3>Feed to Diaper Ratio</h3>
            <canvas id="ratioChart" width="300" height="200"></canvas>
            <div class="graph-guide">
              <strong>ğŸ’š Healthy: 1-2 diapers per feed</strong><br />
              &lt;1:1 = Monitor intake â€¢ 1-2:1 = Good â€¢ &gt;2:1 = Great
            </div>
          </div>
        </div>
      </main>
    </div>

    <!-- Settings Screen (Full Page) -->
    <div class="screen screen-modal" id="settingsScreen" hidden>
      <header class="screen-header">
        <h1>âš™ï¸ Settings</h1>
        <div></div>
      </header>

      <main class="screen-content">
        <div class="settings">
          <!-- Google Sheets Sync Section -->
          <section class="settings-section">
            <h2 class="settings-section-title">â˜ï¸ Google Sheets Sync</h2>

            <div
              class="sync-notice sync-notice-success"
              id="syncNoticeSuccess"
              hidden
            >
              <span>âœ“ Connected to Google Sheets</span>
            </div>

            <label class="field">
              <span class="field-label">Sync URL</span>
              <input
                type="url"
                id="appsScriptUrl"
                class="input"
                placeholder="https://script.google.com/macros/s/.../exec"
              />
            </label>

            <div class="settings-actions">
              <button
                id="saveSettingsBtn"
                class="btn-rounded btn-primary"
                style="width: 100%"
              >
                <span class="btn-text">ğŸ’¾ Connect & Sync</span>
                <span class="btn-loading" hidden>ğŸ”„ Syncing...</span>
              </button>
            </div>

            <small class="hint">
              ğŸ’¡ Paste your Google Sheets Web App URL above. Leave blank to keep
              everything local only.
            </small>

            <button
              id="viewHelpBtn"
              class="btn-rounded btn-secondary"
              style="margin-top: 1rem; width: 100%"
            >
              ğŸ“– View Setup Guide
            </button>
          </section>

          <!-- Theme Section -->
          <section class="settings-section">
            <h2 class="settings-section-title">ğŸ¨ Theme</h2>

            <div class="theme-options">
              <label class="theme-option">
                <input type="radio" name="theme" value="blossom" checked />
                <span class="theme-name">ğŸŒ¸ Blossom</span>
              </label>
              <label class="theme-option">
                <input type="radio" name="theme" value="comet" />
                <span class="theme-name">â˜„ï¸ Comet</span>
              </label>
              <label class="theme-option">
                <input type="radio" name="theme" value="meadow" />
                <span class="theme-name">ğŸŒ¿ Meadow</span>
              </label>
            </div>
          </section>

          <!-- Action Types Section -->
          <section class="settings-section">
            <h2 class="settings-section-title">ğŸ“ Activity Types</h2>
            <p class="settings-section-description">
              Customize the activities you want to track. Each activity has a
              name, emoji, and color.
            </p>

            <div id="actionTypesList" class="action-types-list">
              <!-- Action types will be rendered here dynamically -->
            </div>

            <button
              id="addActionTypeBtn"
              class="btn-rounded btn-secondary"
              style="width: 100%; margin-top: 12px"
            >
              â• Add New Activity
            </button>
          </section>
        </div>
      </main>
    </div>

    <!-- Help/Documentation Screen -->
    <div class="screen screen-modal" id="helpScreen" hidden>
      <header class="screen-header">
        <button class="back-btn" data-back="settings">â† Back</button>
        <h1>ğŸ“– Setup Guide</h1>
        <div></div>
      </header>

      <main class="screen-content" style="padding: 1rem">
        <div id="helpContent" class="help-content">
          Loading documentation...
        </div>
      </main>
    </div>

    <!-- Action Type Editor Modal -->
    <div class="modal-overlay" id="actionTypeModal" hidden>
      <div class="modal-content">
        <div class="modal-header">
          <h3 id="modalTitle">Add Activity</h3>
          <button class="modal-close" id="closeModalBtn">âœ•</button>
        </div>
        <div class="modal-body">
          <input type="hidden" id="editingTypeId" />

          <label class="field">
            <span class="field-label">Activity Name</span>
            <input
              type="text"
              id="typeNameInput"
              class="input"
              placeholder="e.g., Sleep, Bath, Play"
              maxlength="20"
            />
          </label>

          <label class="field">
            <span class="field-label">Emoji</span>
            <input
              type="text"
              id="typeEmojiInput"
              class="input emoji-input"
              placeholder="ğŸ˜´"
              maxlength="2"
            />
          </label>

          <label class="field">
            <span class="field-label">Color</span>
            <div class="color-picker">
              <input type="color" id="typeColorInput" value="#a8d5ff" />
              <input
                type="text"
                id="typeColorText"
                class="input"
                value="#a8d5ff"
                maxlength="7"
              />
            </div>
          </label>
        </div>
        <div class="modal-footer">
          <button id="cancelModalBtn" class="btn-rounded btn-secondary">
            Cancel
          </button>
          <button id="saveTypeBtn" class="btn-rounded btn-primary">Save</button>
        </div>
      </div>
    </div>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
      <button class="nav-item active" data-screen="home">
        <span class="nav-icon">ğŸ </span>
        <span class="nav-label">Home</span>
      </button>
      <button class="nav-item" data-screen="log" id="viewLogBtn">
        <span class="nav-icon">ğŸ“‹</span>
        <span class="nav-label">Log</span>
      </button>
      <button class="nav-item" data-screen="insights" id="viewGraphsBtn">
        <span class="nav-icon">ğŸ“ˆ</span>
        <span class="nav-label">Insights</span>
      </button>
      <button class="nav-item" data-screen="settings" id="openSettingsBtn">
        <span class="nav-icon">âš™ï¸</span>
        <span class="nav-label">Settings</span>
      </button>
    </nav>

    <div id="toast" role="status" aria-live="polite"></div>

    <!-- Floating Undo Button -->
    <button id="undoBtn" class="floating-undo" hidden>
      <span class="undo-icon">â†©ï¸</span>
      <span class="undo-text">Undo</span>
    </button>

    <!-- Hidden elements for legacy compatibility -->
    <div hidden>
      <div id="progressWrap"></div>
      <div id="progressBar"></div>
      <div id="progressLabel"></div>
      <table id="logTable">
        <tbody id="logTbody"></tbody>
      </table>
      <div id="settingsPanel"></div>
      <div id="logPanel"></div>
      <div id="graphsPanel"></div>
    </div>

    <script src="app.js"></script>
  </body>
</html>
